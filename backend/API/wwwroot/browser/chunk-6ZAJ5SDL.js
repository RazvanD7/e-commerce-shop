import{a as y}from"./chunk-36MMH64F.js";import{Bb as N,Eb as $,Ma as U,Na as V,Q as o,Ta as P,U as s,Ub as R,V as d,W as f,Zb as z,_,ba as i,fa as n,ga as l,h as c,ha as g,hb as q,jb as b,mb as A,n as O,na as v,oa as L,p as j,q as G,r as T,rb as m,s as D,sb as C,tb as h,ub as B,vb as E,x as u,xb as S,ya as p,za as k,zb as F}from"./chunk-UDTUQTR4.js";var w=class r{constructor(t,e,a){this.accountService=t;this.router=e;this.activatedRoute=a}loginForm;returnUrl;ngOnInit(){this.returnUrl=this.activatedRoute.snapshot.queryParams.returnUrl||"/shop",this.createLoginForm()}createLoginForm(){this.loginForm=new B({email:new E("",[m.required,m.pattern("^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$")]),password:new E("",m.required)})}onSubmit(){this.accountService.login(this.loginForm.value).subscribe(()=>{this.router.navigateByUrl(this.returnUrl)},t=>{console.log(t)})}static \u0275fac=function(e){return new(e||r)(s(y),s(b),s(q))};static \u0275cmp=d({type:r,selectors:[["app-login"]],standalone:!1,decls:10,vars:5,consts:[[1,"d-flex","justify-content-center","mt-5"],[1,"col-sm-6","col-md-5","col-lg-4"],[3,"ngSubmit","formGroup"],[1,"text-center","mb-4"],[1,"h3","mb-3","font-weight-normal"],["formControlName","email",3,"label"],["formControlName","password",3,"label","type"],["type","submit",1,"btn","btn-primary","btn-block",3,"disabled"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"form",2),v("ngSubmit",function(){return a.onSubmit()}),n(3,"div",3)(4,"h1",4),p(5,"Login"),l()(),g(6,"app-text-input",5)(7,"app-text-input",6),n(8,"button",7),p(9,"Sign in"),l()()()()),e&2&&(o(2),i("formGroup",a.loginForm),o(4),i("label","Email Address"),o(),i("label","Password")("type","password"),o(),i("disabled",a.loginForm.invalid))},dependencies:[S,C,h,F,N,R],styles:[".btn.btn-primary.btn-block[_ngcontent-%COMP%]{width:100%}"]})};function Z(r,t){if(r&1&&(n(0,"li"),p(1),l()),r&2){let e=t.$implicit;o(),k(e)}}function ee(r,t){if(r&1&&(n(0,"ul",10),_(1,Z,2,1,"li",11),l()),r&2){let e=L();o(),i("ngForOf",e.errors)}}var x=class r{constructor(t,e,a){this.fb=t;this.accountService=e;this.router=a}registerForm;errors;ngOnInit(){this.createRegisterForm()}createRegisterForm(){this.registerForm=this.fb.group({displayName:[null,[m.required]],email:[null,[m.required,m.pattern("^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$")],[this.validateEmailNotTaken()]],password:[null,[m.required]]})}onSubmit(){this.accountService.register(this.registerForm.value).subscribe({next:t=>{this.router.navigateByUrl("/shop")},error:t=>{console.log(t),this.errors=Object.keys(t.error.errors).map(e=>t.error.errors[e])}})}validateEmailNotTaken(){return t=>!t.value||t.invalid?c(null):this.accountService.checkEmailExists(t.value).pipe(O(500),G(),D(e=>e?c({emailExists:!0}):c(null)),j(1e3),T(()=>{}))}static \u0275fac=function(e){return new(e||r)(s($),s(y),s(b))};static \u0275cmp=d({type:r,selectors:[["app-register"]],standalone:!1,decls:12,vars:6,consts:[[1,"d-flex","justify-content-center","mt-5"],[1,"col-sm-6","col-md-5","col-lg-4"],[3,"ngSubmit","formGroup"],[1,"text-center","mb-4"],[1,"h3","mb-3","font-weight-normal"],["formControlName","displayName",3,"label"],["formControlName","email",3,"label"],["formControlName","password",3,"label","type"],["class","text-danger list-unstyled",4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-block"],[1,"text-danger","list-unstyled"],[4,"ngFor","ngForOf"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"form",2),v("ngSubmit",function(){return a.onSubmit()}),n(3,"div",3)(4,"h1",4),p(5,"Register"),l()(),g(6,"app-text-input",5)(7,"app-text-input",6)(8,"app-text-input",7),_(9,ee,2,1,"ul",8),n(10,"button",9),p(11,"Register"),l()()()()),e&2&&(o(2),i("formGroup",a.registerForm),o(4),i("label","Display Name"),o(),i("label","Email Address"),o(),i("label","Password")("type","password"),o(),i("ngIf",a.errors))},dependencies:[U,V,S,C,h,F,N,R],styles:[".btn.btn-primary.btn-block[_ngcontent-%COMP%]{width:100%}"]})};var te=[{path:"login",component:w},{path:"register",component:x}],I=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=f({type:r});static \u0275inj=u({imports:[A.forChild(te),A]})};var H=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=f({type:r});static \u0275inj=u({imports:[P,I,z]})};export{H as a};
