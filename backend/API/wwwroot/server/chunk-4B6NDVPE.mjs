import './polyfills.server.mjs';
import{a as m}from"./chunk-YEVRXZP6.mjs";import{$b as p,A as d,D as a,Zb as l,d as c,g as i,j as s,mc as h,o as u,x as o}from"./chunk-27Z4IK5P.mjs";var f=class n{constructor(t,e){this.http=t;this.router=e}baseUrl=m.apiUrl;currentUserSource=new c(1);currentUser$=this.currentUserSource.asObservable();loadCurrentUser(t){if(t===null)return this.currentUserSource.next(void 0),i(void 0);localStorage.setItem("token",t);let e=new l;return e=e.set("Authorization",`Bearer ${t}`),this.http.get(this.baseUrl+"account",{headers:e}).pipe(s(r=>{if(r)return this.currentUserSource.next(r),r;this.currentUserSource.next(void 0)}),u(r=>(console.log(r),this.currentUserSource.next(void 0),i(void 0))))}login(t){return this.http.post(this.baseUrl+"account/login",t).pipe(o(e=>{e&&(localStorage.setItem("token",e.token),this.currentUserSource.next(e))}),s(()=>{}))}register(t){return this.http.post(this.baseUrl+"account/register",t).pipe(o(e=>{e&&(localStorage.setItem("token",e.token),this.currentUserSource.next(e))}),s(()=>{}))}logout(){localStorage.removeItem("token"),this.currentUserSource.next(void 0),this.router.navigateByUrl("/")}checkEmailExists(t){return this.http.get(this.baseUrl+"account/emailexists?email="+t)}updateUserAddress(t){return this.http.put(this.baseUrl+"account/address",t)}getUserAddress(){return this.http.get(this.baseUrl+"account/address")}static \u0275fac=function(e){return new(e||n)(a(p),a(h))};static \u0275prov=d({token:n,factory:n.\u0275fac,providedIn:"root"})};export{f as a};
